# ì€í–‰ ì°½êµ¬ ë§¤ë‹ˆì €

---
# ì€í–‰ ì°½êµ¬ ë§¤ë‹ˆì € í”„ë¡œì íŠ¸ ğŸ¦
> ì€í–‰ì—ì„œ ì˜ˆê¸ˆ, ëŒ€ì¶œ ì—…ë¬´ë¥¼ ì›í•˜ëŠ” ì—¬ëŸ¬ ê³ ê°ì„ ì—¬ëŸ¬ ì€í–‰ì›ì´ 1:1ë¡œ ë§¤ì¹­ë˜ì–´ ì—…ë¬´ë¥¼ ì²˜ë¦¬í•˜ëŠ” í”„ë¡œì íŠ¸
---
## ëª©ì°¨ ğŸ“‹
1. [íŒ€ì› ì†Œê°œ](#íŒ€ì›-ì†Œê°œ)
2. [íƒ€ì„ ë¼ì¸](#íƒ€ì„ë¼ì¸)
3. [UML](#UML)
4. [ì‹¤í–‰í™”ë©´](#ì‹¤í–‰í™”ë©´)
5. [íŠ¸ëŸ¬ë¸” ìŠˆíŒ…](#íŠ¸ëŸ¬ë¸”-ìŠˆíŒ…)
6. [Reference](#Reference)
7. [íŒ€ íšŒê³ ](#íŒ€-íšŒê³ )

## íŒ€ì› ì†Œê°œ

| í˜œëª¨ë¦¬ | ë ˆì˜¹ì•„ë²” |
|:----:| :----: |
|<div width="130" height="200"><img src="https://github.com/hyemory/ios-bank-manager/blob/step3/images/hyemory.png?raw=true" width="130" height="130"/></div>|<div width="130" height="200"><img src="https://github.com/hyemory/ios-bank-manager/blob/step3/images/leon.jpeg?raw=true" width="130"></div>|
| [<img src="https://i.imgur.com/IOAJpzu.png" width="22"/> Github](https://github.com/hyemory) | [<img src="https://i.imgur.com/IOAJpzu.png" width="22"/> Github](https://github.com/fatherLeon) |

## íƒ€ì„ë¼ì¸

|ë‚ ì§œ|ì§„í–‰ ë‚´ì—­|
|:-:|:-:|
|2023.3.6.(ì›”)|`Console App` : LinkedList, Queue êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸ ì§„í–‰|
|2023.3.7.(í™”)|`Console App` : Customer, Bank íƒ€ì… êµ¬í˜„|
|2023.3.8.(ìˆ˜)|`Console App` : ì „ì²´ ì½”ë“œ ë¦¬íŒ©í† ë§|
|2023.3.9.(ëª©)|`Console App` : ë„¤ì´ë° ìˆ˜ì • ë° ì¼ë¶€ ë©”ì†Œë“œ ì¶”ê°€ êµ¬í˜„|
|2023.3.10.(ê¸ˆ)|GCD í•™ìŠµ ë° í”„ë¡œì íŠ¸ íšŒê³ |
|2023.3.13.(ì›”)|`UI App` : ë ˆì´ì•„ì›ƒ êµ¬í˜„|
|2023.3.14.(í™”)|`Console App` ìˆ˜ì •ì‚¬í•­ ë°˜ì˜ ë° ë¦¬íŒ©í† ë§ <br/> `UI App` : ë²„íŠ¼ ë™ì‘ êµ¬í˜„|
|2023.3.15.(ìˆ˜)|`UI App` : ì „ë°˜ì ì¸ ê¸°ëŠ¥ êµ¬í˜„|
|2023.3.16.(ëª©)|`UI App` : ì˜¤ë¥˜ ìˆ˜ì • ë° ë¦¬íŒ©í† ë§|
|2023.3.17.(ê¸ˆ)|í”„ë¡œì íŠ¸ íšŒê³  ë° ìˆ˜ì •ì‚¬í•­ ë°˜ì˜|

## UML

<details>
<summary><Big>Class Diagram ë³´ê¸°</Big></summary>
    
![](https://github.com/hyemory/ios-bank-manager/blob/ee4c63b9a41fea10ca442e8764f5bfe2a1e6ea87/images/ClassDiagram.png?raw=true)
    
</div>
</details>

</br>

---

## ì‹¤í–‰í™”ë©´

|Console ì•± <br/> 1: ê¸°ëŠ¥ ì‹¤í–‰ / 2: ì•± ì¢…ë£Œ|
|:-:|
|![](https://github.com/hyemory/ios-bank-manager/blob/step4/images/ì½˜ì†”ì•±ì‹¤í–‰í™”ë©´.gif?raw=true)|

|10ëª… ì¶”ê°€ í›„ ì—…ë¬´ ì™„ë£Œ|ì—…ë¬´ ì¤‘ ê³ ê° ì¶”ê°€|ì—…ë¬´ ì™„ë£Œ + ì‹¤í–‰ ì¤‘ ì´ˆê¸°í™”|
|:-:|:-:|:-:|
|![](https://github.com/hyemory/ios-bank-manager/blob/85a28dd979b668b84b27b239a1d9f01ba8927e0a/images/addCustomer_10.gif?raw=true)|![](https://github.com/hyemory/ios-bank-manager/blob/85a28dd979b668b84b27b239a1d9f01ba8927e0a/images/addCustomer_30.gif?raw=true)|![](https://github.com/hyemory/ios-bank-manager/blob/85a28dd979b668b84b27b239a1d9f01ba8927e0a/images/reset.gif?raw=true)|



## íŠ¸ëŸ¬ë¸” ìŠˆíŒ…

### 1ï¸âƒ£ Unit test ì˜¤ë¥˜

#### â“ ë¬¸ì œì 

Unit test ì‹œ ì ‘ê·¼ ìˆ˜ì¤€ì´ internalì¸ íƒ€ì…ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì´ í”„ë¡œì íŠ¸ë¥¼ importí•˜ì˜€ìŠµë‹ˆë‹¤.

``` swift
@testable import BankManagerConsoleApp
```

ê·¸ëŸ¬ë‚˜ Unit testë¥¼ ëŒë¦¬ë‹ˆ ì•„ë˜ ì´ë¯¸ì§€ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

![](https://github.com/hyemory/ios-bank-manager/blob/step3/images/error.png?raw=true)

#### ğŸ“– í•´ê²°ë²•

* í˜„ì¬ `Command Line Tool` í™˜ê²½ì—ì„œ êµ¬í˜„ ì¤‘ì¸ë° `testable`ì˜ ê²½ìš° iOS MacOS ë“±ë“± UIí™˜ê²½ì„ ê°œë°œí•  ê²½ìš°ì—ë§Œ ì‚¬ìš©ê°€ëŠ¥í•œ ê²ƒì„ ì•Œì•˜ìŠµë‹ˆë‹¤.
* ë”°ë¼ì„œ, `Target Membership`ì„ í†µí•˜ì—¬ ìœ ë‹›í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

### 2ï¸âƒ£ í•˜ë‚˜ì˜ node ì‹¤í–‰ í›„ ë™ì‘ì„ 0.7ì´ˆ ë©ˆì¶”ëŠ” ë°©ë²• ê³ ë¯¼(Sleep)

#### â“ ë¬¸ì œì 
* Serialíì— syncì‘ì—… ê²°ì • í›„ í•˜ë‚˜ì˜ ì‘ì—… ë‹¹ 0.7ì´ˆì”© ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì— ëŒ€í•´ ê³ ë¯¼í–ˆìŠµë‹ˆë‹¤.
```swift
func sleep(_: UInt32) -> UInt32
```
* ê°€ì¥ ë¨¼ì € ìƒê°ë‚œê²Œ ìœ„ ë©”ì†Œë“œì˜€ì§€ë§Œ UInt32ë¼ì„œ ì •ìˆ˜í˜•ë§Œ ë°›ëŠ” ë¬¸ì œ ë•Œë¬¸ì— ë‹¤ë¥¸ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.


#### ğŸ“– í•´ê²°ë²•
```swift
class func sleep(forTimeInterval: TimeInterval)
```

* `Thread`ì— êµ¬í˜„ëœ íƒ€ì…ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°ê°ì˜ Taskë§ˆë‹¤ 0.7ì´ˆì”© ì‹œê°„ì„ ê¸°ë‹¤ë¦¬ë„ë¡ ë§Œë“¤ì–´ ì£¼ì—ˆìŠµë‹ˆë‹¤.
* Serialíë¥¼ ì‚¬ìš©í•˜ì—¬ ì“°ë ˆë“œê°€ í•˜ë‚˜ë©° mainì“°ë ˆë“œê°€ ì•„ë‹ˆë¯€ë¡œ ë©ˆì¶”ì–´ë„ í° ë¬¸ì œê°€ ì—†ì—ˆê³  syncë™ê¸°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì—…ì´ ëë‚ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ë¯€ë¡œ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

```swift
private static func work(for customer: Customer) {
    let workQueue = DispatchQueue(label: "WorkQueue")

    let queueItem = DispatchWorkItem {
        print("\(customer.waitingNumber)ë²ˆ ê³ ê° \(customer.desiredBanking)ì—…ë¬´ ì‹œì‘")
        Thread.sleep(forTimeInterval: customer.desiredBanking.time)
        print("\(customer.waitingNumber)ë²ˆ ê³ ê° \(customer.desiredBanking)ì—…ë¬´ ì™„ë£Œ")
    }

    workQueue.sync(execute: queueItem)
}
```

### 3ï¸âƒ£ ìº¡ì³ë¦¬ìŠ¤íŠ¸ì˜ ê°•í•œìˆœí™˜ì°¸ì¡° ë¬¸ì œ

#### â“ ë¬¸ì œì 
```swift
DispatchQueue.main.async { [self] in
    workingStackView.removeLabel(customer: customer)
}
```

* ìœ„ì™€ ê°™ì€ ì½”ë“œê°€ ìˆì„ ê²½ìš° ìº¡ì³ë¦¬ìŠ¤íŠ¸ê°€ `[self]` ì´ë¯€ë¡œ ê°•í•œì°¸ì¡°ì´ë¯€ë¡œ ê°•í•œìˆœí™˜ì°¸ì¡° ë¬¸ì œê°€ ë°œìƒí• ê²ƒ ê°™ë‹¤ëŠ” ìš°ë ¤ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

#### ğŸ“– í•´ê²°ë²•
* ë§Œì•½ `DispatchWorkItem`ì„ ì‚¬ìš©í•˜ì—¬ í´ë¡œì €ë¥¼ í”„ë¡œí¼í‹°ë¡œ ê°€ì§€ê³  ìˆë‹¤ë©´ ê°•í•œìˆœí™˜ì°¸ì¡° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ë„ ìˆì§€ë§Œ, ìœ„ ì½”ë“œì™€ ê°™ì´ ë©”ì†Œë“œì˜ ì¸ìë¡œ í´ë¡œì €ë¥¼ ì¤„ ê²½ìš° ê³§ë°”ë¡œ ì‹¤í–‰ë˜ë¯€ë¡œ ê°•í•œìˆœí™˜ì°¸ì¡° ë¬¸ì œëŠ” ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ë°°ì› ìŠµë‹ˆë‹¤.
* ë˜í•œ GCDì—ì„œ ìº¡ì³ë¦¬ìŠ¤íŠ¸ë¥¼ í†µí•œ ì°¸ì¡°ëŠ” ë‹¨ìˆœíˆ ê°•í•œìˆœí™˜ì°¸ì¡°ë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ê°ì²´ì˜ ìƒëª…ì£¼ê¸°ë¥¼ ìƒê°í•˜ë©°, ì‚¬ìš©í•´ì•¼í•œë‹¤ëŠ” ê²ƒì„ ë°°ì› ìŠµë‹ˆë‹¤.


### 4ï¸âƒ£ íƒ€ì´ë¨¸ ì‹œì‘ ì‹œê°„ì´ 0ìœ¼ë¡œ ì„¸íŒ…ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ

#### â“ ë¬¸ì œì 
``` swift
var date = Date()
```

- Dateì˜ ì´ë‹ˆì…œë¼ì´ì €ë¥¼ Labelì— ë„£ì–´ì£¼ë‹ˆ íƒ€ì´ë¨¸ê°€ í˜„ì¬ ì‹œê°„ë¶€í„° ì‹œì‘ë˜ëŠ” í˜„ìƒì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. 

#### ğŸ“– í•´ê²°ë²•
``` swift
private func configureTimer() {
    if timer != nil { return }

    var date = Date(timeIntervalSince1970: 0)

    timer = DispatchSource.makeTimerSource(queue: .main)
    timer?.schedule(deadline: .now(), repeating: .milliseconds(BankOption.timerMilliSecond))

    timer?.setEventHandler(handler: { [self] in
        date = date.addingTimeInterval(BankOption.timerSecond)

        workTimeLabel.text = "ì—…ë¬´ì‹œê°„ - \(date.applyDateFormatter())"
    })

    timer?.resume()
    isRunningTimer = true
}
```

- Dateì˜ ì´ë‹ˆì…œë¼ì´ì € `timeIntervalSince1970`ë¥¼ 0ìœ¼ë¡œ ì„¤ì •í•˜ë‹ˆ í•´ê²°ë˜ì—ˆìŠµë‹ˆë‹¤. (1970ë…„ 1ì›” 1ì¼ 00:00:00)

### 5ï¸âƒ£ ì´ˆê¸°í™” ë²„íŠ¼ í´ë¦­ ì‹œ ê¸°ì¡´ ì‘ì—… ì •ì§€

#### â“ ë¬¸ì œì 
* ìš”êµ¬ì‚¬í•­ì— ë”°ë¼ ì´ˆê¸°í™” ë²„íŠ¼ì„ í´ë¦­ ì‹œ ê¸°ì¡´ì˜ ì‘ì—…ë“¤ì´ ì „ë¶€ ì‚¬ë¼ì§€ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í–ˆìŠµë‹ˆë‹¤.
* ì´ˆê¸°í™” ë²„íŠ¼ í´ë¦­ì‹œ ê¸°ì¡´ì˜ ì‘ì—…ë“¤ì€ ì „ë¶€ ì‚¬ë¼ì ¸ë„ ì´ë¯¸ ì“°ë ˆë“œ ë‚´ì—ì„œ ì‹¤í–‰ì¤‘ í˜¹ì€ ì‹¤í–‰ì˜ˆì •ì´ë˜ ì‘ì—…ë“¤ì€ ì‚¬ë¼ì§€ì§€ ì•Šê³  ì´í›„ `ì—…ë¬´ì¤‘` ë·°ì— ë¼ë²¨ë¡œ í‘œì‹œê°€ ë˜ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.
* `DispatchQueue`ì—ëŠ” í˜„ì¬ ì“°ë ˆë“œì— ë“¤ì–´ê°€ ìˆëŠ” ì‘ì—…ì„ ì‚­ì œí•˜ëŠ” ë°©ë²•, ì“°ë ˆë“œ ì‚­ì œ ë“±ì˜ ë°©ë²•ì´ êµ¬í˜„ë˜ì–´ìˆì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

#### ğŸ“– í•´ê²°ë²•
```swift
private static func work(for customer: Customer) {
    let workQueue = DispatchQueue(label: "WorkQueue")

    let queueItem = DispatchWorkItem(qos: .userInitiated) {
        if isRunningWork {
            NotificationCenter.default.post(name: .workingNoti, object: customer)
            Thread.sleep(forTimeInterval: customer.desiredBanking.time)
            NotificationCenter.default.post(name: .completeNoti, object: customer)
        }
    }

    workQueue.sync(execute: queueItem)
}
```

* ìƒíƒœ ë³€ìˆ˜(Flag)ë¥¼ ì¶”ê°€í•˜ì—¬ í•´ë‹¹ ë³€ìˆ˜ê°€ `False`ì¼ ê²½ìš° ì´ˆê¸°í™” ë²„íŠ¼ì„ ëˆŒë €ë‹¤ê³  íŒë‹¨í•˜ì—¬ `Thread.sleep`ì„ ë™ì‘í•˜ì§€ ì•Šë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
* ìœ„ ë°©ë²•ìœ¼ë¡œ êµ¬í˜„ì„ í• ì‹œ ì´ˆê¸°í™” ë²„íŠ¼ì„ ëˆ„ë¥¼ ê²½ìš° `ì—…ë¬´ì¤‘`ë·°ì— ë¼ë²¨ì´ ì¶”ê°€ë˜ì§€ë„ ì•Šì„ ë¿ë”ëŸ¬ ì´í›„ ì‘ì—…ê³¼ ê°™ì´ ë™ì‘í•˜ì§€ ì•Šë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

## Reference

- [ì• í”Œ ê³µì‹ë¬¸ì„œ - timeIntervalSince(_:)](https://developer.apple.com/documentation/foundation/date/1779636-timeintervalsince)
- [ì• í”Œ ê³µì‹ë¬¸ì„œ - sleep(forTimeInterval:)](https://developer.apple.com/documentation/foundation/thread/1413673-sleep)
- [ì• í”Œ ê³µì‹ë¬¸ì„œ - DispatchQueue](https://developer.apple.com/documentation/dispatch/dispatchqueue)
- [ì• í”Œ ê³µì‹ë¬¸ì„œ - DispatchWorkItem](https://developer.apple.com/documentation/dispatch/dispatchworkitem)
- [ì• í”Œ ê³µì‹ë¬¸ì„œ - TimeInterval](https://developer.apple.com/documentation/foundation/timeinterval)
- [ì• í”Œ ê³µì‹ë¬¸ì„œ - QOS ìš°ì„ ìˆœìœ„ ë¬¸ì œ](https://developer.apple.com/documentation/xcode/diagnosing-performance-issues-early)
- [ì• í”Œ ê³µì‹ë¬¸ì„œ - DispatchSourceTimer](https://developer.apple.com/documentation/dispatch/dispatchsourcetimer)
- [ì• í”Œ Documentation Archive - Data Formatters](https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW10)
- [ì•¼ê³°ë‹·ë„· - Concurrency Programming](https://yagom.net/courses/%EB%8F%99%EC%8B%9C%EC%84%B1-%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D-concurrency-programming/)
- [GCDì˜ ìˆœí™˜ì°¸ì¡°](https://medium.com/@almalehdev/you-dont-always-need-weak-self-a778bec505ef)


## íŒ€ íšŒê³ 

<details>
<summary> íŒ€ íšŒê³  ë‚´ìš© ë³´ê¸° </summary>

### ìš°ë¦¬íŒ€ì´ ì˜í•œ ì 
- ë§¤ì¼ ì„±ì‹¤í•˜ê²Œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ì—¬ ì‹œê°„ ë‚´ì— í”„ë¡œì íŠ¸ë¥¼ ë§ˆì¹œ ì 
- ì½”ë“œ ì»¨ë²¤ì…˜ì„ ì˜ í˜‘ì˜í•˜ê³  ì§€í‚¨ ì 
- ì ì ˆí•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ í™œìš©í•˜ì˜€ë‹¤ëŠ” ì 

### ìš°ë¦¬íŒ€ ê°œì„ í•  ì 
- íƒ€ì…í”„ë¡œí¼í‹°ì™€ íƒ€ì…ë©”ì†Œë“œì˜ ë¬´ë¶„ë³„í•œ ì‚¬ìš©
- ë‹¤ì–‘í•œ ì‹œë„ë¥¼ í•˜ì§€ ëª»í–ˆë‹¤ëŠ” ì 

### ì„œë¡œ ì¹­ì°¬í•˜ê¸°
- ë ˆì˜¹ì•„ë²” -> í˜œëª¨ë¦¬
    - 2ì£¼ê°„ ë°”ìœì¼ì •ì†ì—ì„œë„ í•­ìƒ ì‹œê°„ì•½ì† ì˜ ì§€í‚¤ì‹œê³  ê¾¸ì¤€í•˜ì…¨ìŠµë‹ˆë‹¤!!ğŸ‘
    - í”„ë¡œì íŠ¸ ì§„í–‰ ê³¼ì • ì¤‘ ì‚¬ì†Œí•œ ë¶€ë¶„ë„ ê¼¼ê¼¼í•˜ê²Œ ì²´í¬í•´ì£¼ì…”ì„œ í”„ë¡œì íŠ¸ ì§„í–‰ì´ í•œê²° í¸í–ˆë˜ê²ƒ ê°™ìŠµë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤ğŸ™‡

- í˜œëª¨ë¦¬ -> ë ˆì˜¹ì•„ë²”
    - ë„ˆë¬´ ì˜í•˜ì…”ì„œ ë”°ë¼ê°€ëŠë¼ ë°”ë¹´ìŠµë‹ˆë‹¤ ğŸ‘ ë¬¸ì œ í•´ê²°ëŠ¥ë ¥ë„ ë„ˆë¬´ ë›°ì–´ë‚˜ì‹œê³  ì´í•´ë ¥ì´ ì¢‹ìœ¼ì…”ì„œ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ë°˜ì˜í•˜ëŠ” ê²ƒë„ ë¹ ë¥´ê²Œ ì˜ í•˜ì…¨ìŠµë‹ˆë‹¤. 
    - ê¼¼ê¼¼í•˜ì‹œê³  ë˜‘ë˜‘í•˜ì…”ì„œ ì´ë²ˆì— ë§ì´ ë°°ì›Œê°‘ë‹ˆë‹¤. ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ™‡ğŸ»â€â™€ï¸
    
</details>

